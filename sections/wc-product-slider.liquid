{{ 'wc-product-slider.css' | asset_url | stylesheet_tag }}
{{ 'wc-product-slider.js' | asset_url | script_tag }}

<section
  class="product-slider-section section-{{ section.id }}-padding"
  role="region"
  aria-labelledby="product-slider-title-{{ section.id }}"
>
  <div class="product-slider-content">
    {% if section.settings.title != blank %}
      <h2
        id="product-slider-title-{{ section.id }}"
        class="product-slider-title"
      >
        {{ section.settings.title }}
      </h2>
    {% endif %}

    <div
      class="product-slider-container"
      role="group"
      aria-roledescription="carousel"
      aria-label="{{ section.settings.title | escape }}"
    >
      {% render 'slider-arrows',
        direction: 'prev',
        class: 'product-slider-arrow product-slider-arrow--prev',
        label: 'Banner anterior'
      %}

      <div class="product-slider-wrapper">
        <div
          class="product-slider-track"
          aria-live="polite"
        >
          {% for product in section.settings.collection.products limit: section.settings.products_to_show %}
            <div
              class="product-card"
              data-product-id="{{ product.id }}"
              role="group"
              aria-label="{{ product.title | escape }}"
            >
              <div class="product-card__media">
                {% if product.featured_image %}
                  <img
                    src="{{ product.featured_image | image_url: width: 500 }}"
                    srcset="{{ product.featured_image | image_url: width: 165 }} 165w,
                            {{ product.featured_image | image_url: width: 360 }} 360w,
                            {{ product.featured_image | image_url: width: 533 }} 533w,
                            {{ product.featured_image | image_url: width: 720 }} 720w,
                            {{ product.featured_image | image_url: width: 940 }} 940w"
                    sizes="(min-width: 1200px) 267px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                    alt="{{ product.featured_image.alt | escape | default: product.title }}"
                    loading="lazy"
                    class="product-card__image"
                  >
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                {% endif %}

                {% if product.compare_at_price > product.price %}
                  {% assign discount_percentage = product.compare_at_price | minus: product.price | times: 100.0 | divided_by: product.compare_at_price | round %}
                  <span
                    class="product-card__badge"
                    aria-label="{{ discount_percentage }}% de desconto"
                  >
                    {{ discount_percentage }}% OFF
                  </span>
                {% endif %}

                <button
                  class="product-card__wishlist"
                  type="button"
                  aria-label="Adicionar {{ product.title }} à lista de desejos"
                >
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>

                <div class="product-card__overlay">
                  <div class="product-card__size-selector">
                    <p class="size-selector__label" id="size-label-{{ product.id }}">
                      Selecione um tamanho
                    </p>

                    <div
                      class="size-selector__options"
                      role="group"
                      aria-labelledby="size-label-{{ product.id }}"
                    >
                      <button
                        class="size-selector__arrow size-selector__arrow--prev"
                        type="button"
                        aria-label="Tamanho anterior"
                      >
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                          <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </button>

                      <div class="size-selector__track-wrapper">
                        <div class="size-selector__track">
                          {% if product.variants.size > 0 %}
                            {% for variant in product.variants %}
                              {% if variant.option1 %}
                                <button
                                  class="size-selector__option {% if forloop.first %}active{% endif %}"
                                  type="button"
                                  data-variant-id="{{ variant.id }}"
                                  aria-pressed="{% if forloop.first %}true{% else %}false{% endif %}"
                                  {% unless variant.available %}disabled{% endunless %}
                                >
                                  {{ variant.option1 }}
                                </button>
                              {% endif %}
                            {% endfor %}
                          {% else %}
                            <button
                              class="size-selector__option active"
                              type="button"
                              aria-pressed="true"
                            >
                              Único
                            </button>
                          {% endif %}
                        </div>
                      </div>

                      <button
                        class="size-selector__arrow size-selector__arrow--next"
                        type="button"
                        aria-label="Próximo tamanho"
                      >
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                          <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </button>
                    </div>
                  </div>

                  <button
                    class="product-card__add-to-cart"
                    type="button"
                    data-product-id="{{ product.id }}"
                    aria-label="Adicionar {{ product.title }} à sacola"
                  >
                    Adicionar à sacola
                  </button>
                </div>
              </div>

              <div class="product-card__info">
                <h3 class="product-card__title">
                  <a href="{{ product.url }}">
                    {{ product.title }}
                  </a>
                </h3>

                <div class="product-card__price">
                  <span class="price price--current">
                    {{ product.price | money }}
                  </span>

                  {% if product.compare_at_price > product.price %}
                    <span class="price price--compare">
                      {{ product.compare_at_price | money }}
                    </span>
                  {% endif %}
                </div>

                {% if section.settings.show_installments %}
                  {% assign installment_value = product.price | divided_by: 6.0 %}
                  <p class="product-card__installments">
                    ou 6x de {{ installment_value | money }} sem juros
                  </p>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      </div>

      {% render 'slider-arrows',
        direction: 'next',
        class: 'product-slider-arrow product-slider-arrow--next',
        label: 'Próximo banner'
      %}
    </div>

    <div
      class="product-slider-dots"
      role="tablist"
      aria-label="Paginação do carrossel"
    ></div>
  </div>
</section>


{% schema %}
{
  "name": "Product Slider",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Título",
      "default": "Favoritos da Semana"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Coleção"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 20,
      "step": 1,
      "label": "Produtos para mostrar",
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "show_installments",
      "label": "Mostrar parcelas",
      "default": true
    },
  ],
  "presets": [
    {
      "name": "Product Slider"
    }
  ]
}
{% endschema %}
